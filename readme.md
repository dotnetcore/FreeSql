## ğŸ¦„ ã€€FreeSql

[![nuget](https://img.shields.io/nuget/v/FreeSql.svg?style=flat-square)](https://www.nuget.org/packages/FreeSql) [![stats](https://img.shields.io/nuget/dt/FreeSql.svg?style=flat-square)](https://www.nuget.org/stats/packages/FreeSql?groupby=Version) [![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://raw.githubusercontent.com/2881099/FreeSql/master/LICENSE.txt)

FreeSql æ˜¯åŠŸèƒ½å¼ºå¤§çš„å¯¹è±¡å…³ç³»æ˜ å°„æŠ€æœ¯(O/RM)ï¼Œæ”¯æŒ .NETCore 2.1+ æˆ– .NETFramework 4.0+ æˆ– Xamarinã€‚

- [x] æ”¯æŒ CodeFirst è¿ç§»ï¼Œå“ªæ€•ä½¿ç”¨ Access æ•°æ®åº“ä¹Ÿæ”¯æŒï¼›
- [x] æ”¯æŒ DbFirst ä»æ•°æ®åº“å¯¼å…¥å®ä½“ç±»ï¼Œ[å®‰è£…å®ä½“ç±»ç”Ÿæˆå·¥å…·](https://github.com/2881099/FreeSql/wiki/DbFirst)ï¼›
- [x] æ”¯æŒ æ·±å…¥çš„ç±»å‹æ˜ å°„ï¼Œæ¯”å¦‚pgsqlçš„æ•°ç»„ç±»å‹ï¼›
- [x] æ”¯æŒ ä¸°å¯Œçš„è¡¨è¾¾å¼å‡½æ•°ï¼Œä»¥åŠçµæ´»çš„è‡ªå®šä¹‰è§£æï¼›
- [x] æ”¯æŒ å¯¼èˆªå±æ€§ä¸€å¯¹å¤šã€å¤šå¯¹å¤šè´ªå©ªåŠ è½½ï¼Œä»¥åŠå»¶æ—¶åŠ è½½ï¼›
- [x] æ”¯æŒ è¯»å†™åˆ†ç¦»ã€åˆ†è¡¨åˆ†åº“ã€è¿‡æ»¤å™¨ã€ä¹è§‚é”ã€æ‚²è§‚é”ï¼›
- [x] æ”¯æŒ MySql/SqlServer/PostgreSQL/Oracle/Sqlite/è¾¾æ¢¦/äººå¤§é‡‘ä»“/ç¥èˆŸé€šç”¨/Accessï¼›

## ğŸ“š ã€€Documentation

| | |
| - | - |
| <img src="https://images.cnblogs.com/cnblogs_com/FreeSql/1656841/o_200424151826freesql_doc1.png" width="30" height="46"/> | [ã€Šæ–°äººå­¦ä¹ æŒ‡å¼•ã€‹](https://www.cnblogs.com/FreeSql/p/11531300.html) \| [ã€ŠSelectã€‹](https://github.com/2881099/FreeSql/wiki/%e6%9f%a5%e8%af%a2) \| [ã€ŠUpdateã€‹](https://github.com/2881099/FreeSql/wiki/%e4%bf%ae%e6%94%b9) \| [ã€ŠInsertã€‹](https://github.com/2881099/FreeSql/wiki/%e6%b7%bb%e5%8a%a0) \| [ã€ŠDeleteã€‹](https://github.com/2881099/FreeSql/wiki/%e5%88%a0%e9%99%a4) |
| <img src="https://images.cnblogs.com/cnblogs_com/FreeSql/1656841/o_200424151831freesql_doc2.png" width="30" height="46"/> | [ã€Šè¡¨è¾¾å¼å‡½æ•°ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%a1%a8%e8%be%be%e5%bc%8f%e5%87%bd%e6%95%b0) \| [ã€ŠCodeFirstã€‹](https://github.com/2881099/FreeSql/wiki/CodeFirst) \| [ã€ŠDbFirstã€‹](https://github.com/2881099/FreeSql/wiki/DbFirst) \| [ã€Šè¿‡æ»¤å™¨ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%bf%87%e6%bb%a4%e5%99%a8) |
| <img src="https://images.cnblogs.com/cnblogs_com/FreeSql/1656841/o_200424151835freesql_doc3.png" width="30" height="46"/> | [ã€ŠRepositoryã€‹](https://github.com/2881099/FreeSql/wiki/Repository) \| [ã€ŠUnitOfWorkã€‹](https://github.com/2881099/FreeSql/wiki/%e5%b7%a5%e4%bd%9c%e5%8d%95%e5%85%83) \| [ã€ŠAOPã€‹](https://github.com/2881099/FreeSql/wiki/AOP) \| [ã€ŠDbContextã€‹](https://github.com/2881099/FreeSql/wiki/DbContext) |
| <img src="https://images.cnblogs.com/cnblogs_com/FreeSql/1656841/o_200424151840freesql_doc4.png" width="30" height="46"/> | [ã€Šè¯»å†™åˆ†ç¦»ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%af%bb%e5%86%99%e5%88%86%e7%a6%bb) \| [ã€Šåˆ†åŒºåˆ†è¡¨ã€‹](https://github.com/2881099/FreeSql/wiki/%e5%88%86%e5%8c%ba%e5%88%86%e8%a1%a8) \| [ã€Šé»‘ç§‘æŠ€ã€‹](https://github.com/2881099/FreeSql/wiki/%E9%AA%9A%E6%93%8D%E4%BD%9C) \| [ã€Šå¸¸è§é—®é¢˜ã€‹](https://github.com/dotnetcore/FreeSql/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)  \| [*æ›´æ–°æ—¥å¿—*](https://github.com/2881099/FreeSql/wiki/%e6%9b%b4%e6%96%b0%e6%97%a5%e5%bf%97) |

> FreeSql æä¾›å¤šç§ä½¿ç”¨ä¹ æƒ¯ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å›¢é˜Ÿåˆé€‚çš„ä¸€ç§ï¼š

- è¦ä¹ˆFreeSqlï¼ŒåŸå§‹ç”¨æ³•ï¼›
- è¦ä¹ˆ[FreeSql.Repository](https://github.com/2881099/FreeSql/wiki/Repository)ï¼Œä»“å‚¨+å·¥ä½œå•å…ƒä¹ æƒ¯ï¼›
- è¦ä¹ˆ[FreeSql.DbContext](https://github.com/2881099/FreeSql/wiki/DbContext)ï¼Œæœ‰ç‚¹åƒefcoreçš„ä½¿ç”¨ä¹ æƒ¯ï¼›
- è¦ä¹ˆ[FreeSql.BaseEntity](https://github.com/2881099/FreeSql/tree/master/Examples/base_entity)ï¼Œæ±‚ç®€å•ä½¿ç”¨è¿™ä¸ªï¼›

> ç¤ºèŒƒé¡¹ç›®

- [zhontai.net Admin åå°ç®¡ç†ç³»ç»Ÿ](https://github.com/zhontai/Admin.Core)
- [A simple and practical CMS implememted by .NET Core](https://github.com/luoyunchong/lin-cms-dotnetcore)
- [iusaas.com SaaS ä¼ä¸šåº”ç”¨ç®¡ç†ç³»ç»Ÿ](https://github.com/alonsoalon/TenantSite.Server)
- [EasyCms ä¼ä¸šå»ºç«™ï¼Œäº‹ä¸šå•ä½ä½¿ç”¨çš„CMSç®¡ç†ç³»ç»Ÿ](https://github.com/jasonyush/EasyCMS)
- [å†…å®¹ç®¡ç†ç³»ç»Ÿ](https://github.com/hejiyong/fscms)

<p align="center">
  <img src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200610084147functions09.png"/>
</p>

## ğŸš€ ã€€Quick start

> dotnet add package FreeSql.Provider.Sqlite

```csharp
static IFreeSql fsql = new FreeSql.FreeSqlBuilder()
  .UseConnectionString(FreeSql.DataType.Sqlite, @"Data Source=document.db")
  .UseAutoSyncStructure(true) //è‡ªåŠ¨åŒæ­¥å®ä½“ç»“æ„åˆ°æ•°æ®åº“
  .Build(); //è¯·åŠ¡å¿…å®šä¹‰æˆ Singleton å•ä¾‹æ¨¡å¼

class Song {
  [Column(IsIdentity = true)]
  public int Id { get; set; }
  public string Title { get; set; }
  public string Url { get; set; }
  public DateTime CreateTime { get; set; }
  
  public ICollection<Tag> Tags { get; set; }
}
class Song_tag {
  public int Song_id { get; set; }
  public Song Song { get; set; }
  
  public int Tag_id { get; set; }
  public Tag Tag { get; set; }
}
class Tag {
  [Column(IsIdentity = true)]
  public int Id { get; set; }
  public string Name { get; set; }
  
  public int? Parent_id { get; set; }
  public Tag Parent { get; set; }
  
  public ICollection<Song> Songs { get; set; }
  public ICollection<Tag> Tags { get; set; }
}
```

## ğŸ” ã€€Query
```csharp
//OneToOneã€ManyToOne
fsql.Select<Tag>().Where(a => a.Parent.Parent.Name == "ç²¤è¯­").ToList();

//OneToMany
fsql.Select<Tag>().IncludeMany(a => a.Tags, then => then.Where(sub => sub.Name == "xxx")).ToList();

//ManyToMany
fsql.Select<Song>()
  .IncludeMany(a => a.Tags, then => then.Where(sub => sub.Name == "xxx"))
  .Where(s => s.Tags.AsSelect().Any(t => t.Name == "å›½è¯­"))
  .ToList();

//Other
fsql.Select<Xxx>()
  .Where(a => a.IsDelete == 0)
  .WhereIf(keyword != null, a => a.UserName.Contains(keyword))
  .WhereIf(role_id > 0, a => a.RoleId == role_id)
  .Where(a => a.Nodes.AsSelect().Any(t => t.Parent.Id == t.UserId))
  .Count(out var total)
  .Page(page, size)
  .OrderByDescending(a => a.Id)
  .ToList()
```
[More..](https://github.com/2881099/FreeSql/wiki/%e6%9f%a5%e8%af%a2)

```csharp
fsql.Select<Song>().Where(a => new[] { 1, 2, 3 }.Contains(a.Id)).ToList();

fsql.Select<Song>().Where(a => a.CreateTime.Date == DateTime.Today).ToList();

fsql.Select<Song>().OrderBy(a => Guid.NewGuid()).Limit(10).ToList();
```
[More..](https://github.com/2881099/FreeSql/wiki/%e8%a1%a8%e8%be%be%e5%bc%8f%e5%87%bd%e6%95%b0) 

## ğŸš ã€€Repository

> dotnet add package FreeSql.Repository

```csharp
[Transactional]
public void Add() {
  var repo = ioc.GetService<BaseRepository<Tag>>();
  repo.DbContextOptions.EnableAddOrUpdateNavigateList = true;

  var item = new Tag {
    Name = "testaddsublist",
    Tags = new[] {
      new Tag { Name = "sub1" },
      new Tag { Name = "sub2" }
    }
  };
  repo.Insert(item);
}
```

å‚è€ƒï¼š[åœ¨ asp.net core ä¸­ä½¿ç”¨ TransactionalAttribute + UnitOfWorkManager å®ç°å¤šç§äº‹åŠ¡ä¼ æ’­](https://github.com/dotnetcore/FreeSql/issues/289)

## ğŸ’ª ã€€Performance

FreeSql Query & Dapper Query
```shell
Elapsed: 00:00:00.6733199; Query Entity Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.4554230; Query Tuple Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.6846146; Query Dynamic Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.6818111; Query Entity Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.6060042; Query Tuple Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.4211323; Query ToList<Tuple> Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:01.0236285; Query Dynamic Counts: 131072; ORM: FreeSql*
```

FreeSql ToList & Dapper Query
```shell
Elapsed: 00:00:00.6707125; ToList Entity Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.6495301; Query Entity Counts: 131072; ORM: Dapper
```

[More..](https://github.com/2881099/FreeSql/wiki/%e6%80%a7%e8%83%bd)

## ğŸ‘¯ ã€€Contributors

[systemhejiyong](https://github.com/systemhejiyong)ã€
[LambertW](https://github.com/LambertW)ã€
[mypeng1985](https://github.com/mypeng1985)ã€
[stulzq](https://github.com/stulzq)ã€
[movingsam](https://github.com/movingsam)ã€
[ALer-R](https://github.com/ALer-R)ã€
[zouql](https://github.com/zouql)ã€
æ·±åœ³|å‡‰èŒ¶ã€
[densen2014](https://github.com/densen2014)ã€
[LiaoLiaoWuJu](https://github.com/LiaoLiaoWuJu)ã€
[hd2y](https://github.com/hd2y)ã€
[tky753](https://github.com/tky753)ã€
[feijie999](https://github.com/feijie999)ã€
constantine

QQç¾¤ï¼š4336577(å·²æ»¡)ã€8578575(åœ¨çº¿)

## ğŸ’• ã€€Donation

L*y 58å…ƒã€èŠ±èŠ± 88å…ƒã€éº¦å…œå¾ˆä¹– 50å…ƒã€ç½‘ç»œæ¥è€… 2000å…ƒã€John 99.99å…ƒã€alex 666å…ƒã€bacongao 36å…ƒã€æ— å 100å…ƒã€Eternity 188å…ƒã€æ— å 10å…ƒã€âŒ’.Helper~..oO 66å…ƒã€ä¹ æƒ¯ä¸è¢«ä¹ æƒ¯ 100å…ƒã€æ— å 100å…ƒã€è”¡æ˜“å–‹ 88.88å…ƒã€ä¸­è®¯ç§‘æŠ€ 1000å…ƒã€Good Good Work 24å…ƒã€ç‚½ç„° 6.6å…ƒã€Nothing 100å…ƒã€å…°å·å¤©æ“èµµ 500å…ƒ

> Thank you for your donation

| [Alipay](https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200417052520IMG_7936(20200123-155553).png) | [WeChat](https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200417052707IMG_7935(20200123-155553).png) |
| - | - |
| <img height="300" src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200417052520IMG_7936(20200123-155553).png"/> | <img height="300" src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200417052707IMG_7935(20200123-155553).png"/> |
