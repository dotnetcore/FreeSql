<p align="center">
  <img height="210" src="https://github.com/2881099/FreeSql/blob/master/logo.png?raw=true"/>
</p>

FreeSql æ˜¯åŠŸèƒ½å¼ºå¤§çš„å¯¹è±¡å…³ç³»æ˜ å°„æŠ€æœ¯(O/RM)ï¼Œæ”¯æŒ .NETCore 2.1+ æˆ– .NETFramework 4.0+ æˆ– Xamarin

æ‰¶æ‘‡ç›´ä¸Šï¼Œè‡³å¼ºORMåªä¸ºè‡ªç”±ç¼–ç ï¼›é¹ç¨‹ä¸‡é‡Œï¼Œè‡³ç®€Linqå¯ä½¿ä¿ç•™é»‘å‘ï¼›æ¨ªæ‰¹ï¼šFreeSqlï¼ˆè¯—äººï¼šCoderï¼‰

# Features

- [x] æ”¯æŒ CodeFirst è¿ç§»ï¼Œå“ªæ€•ä½¿ç”¨ Access æ•°æ®åº“ä¹Ÿæ”¯æŒï¼›
- [x] æ”¯æŒ DbFirst ä»æ•°æ®åº“å¯¼å…¥å®ä½“ç±»ï¼Œ[å®‰è£…å®ä½“ç±»ç”Ÿæˆå·¥å…·](https://github.com/2881099/FreeSql/wiki/DbFirst)ï¼›
- [x] æ”¯æŒ æ·±å…¥çš„ç±»å‹æ˜ å°„ï¼Œæ¯”å¦‚pgsqlçš„æ•°ç»„ç±»å‹ï¼›
- [x] æ”¯æŒ ä¸°å¯Œçš„è¡¨è¾¾å¼å‡½æ•°ï¼Œä»¥åŠçµæ´»çš„è‡ªå®šä¹‰è§£æï¼›
- [x] æ”¯æŒ å¯¼èˆªå±æ€§ä¸€å¯¹å¤šã€å¤šå¯¹å¤šè´ªå©ªåŠ è½½ï¼Œä»¥åŠå»¶æ—¶åŠ è½½ï¼›
- [x] æ”¯æŒ è¯»å†™åˆ†ç¦»ã€åˆ†è¡¨åˆ†åº“ï¼Œç§Ÿæˆ·è®¾è®¡ï¼Œè¿‡æ»¤å™¨ï¼Œä¹è§‚é”ï¼Œæ‚²è§‚é”ï¼›
- [x] æ”¯æŒ MySql/SqlServer/PostgreSQL/Oracle/Sqlite/è¾¾æ¢¦æ•°æ®åº“/Accessï¼›

| | |
| - | - |
| <img src="https://user-images.githubusercontent.com/16286519/55138232-f5e19e80-516d-11e9-9144-173cc7e52845.png" width="40" height="59"/> | [ã€Šæ–°äººå­¦ä¹ æŒ‡å¼•ã€‹](https://www.cnblogs.com/FreeSql/p/11531300.html) \| [ã€ŠSelectã€‹](https://github.com/2881099/FreeSql/wiki/%e6%9f%a5%e8%af%a2) \| [ã€ŠUpdateã€‹](https://github.com/2881099/FreeSql/wiki/%e4%bf%ae%e6%94%b9) \| [ã€ŠInsertã€‹](https://github.com/2881099/FreeSql/wiki/%e6%b7%bb%e5%8a%a0) \| [ã€ŠDeleteã€‹](https://github.com/2881099/FreeSql/wiki/%e5%88%a0%e9%99%a4) |
| <img src="https://user-images.githubusercontent.com/16286519/55138241-faa65280-516d-11e9-8b27-139dea46e4df.png" width="40" height="59"/> | [ã€Šè¡¨è¾¾å¼å‡½æ•°ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%a1%a8%e8%be%be%e5%bc%8f%e5%87%bd%e6%95%b0) \| [ã€ŠCodeFirstã€‹](https://github.com/2881099/FreeSql/wiki/CodeFirst) \| [ã€ŠDbFirstã€‹](https://github.com/2881099/FreeSql/wiki/DbFirst) \| [ã€ŠBaseEntityã€‹](https://github.com/2881099/FreeSql/tree/master/Examples/base_entity) |
| <img src="https://user-images.githubusercontent.com/16286519/55138263-06921480-516e-11e9-8da9-81f18a18b694.png" width="40" height="59"/> | [ã€ŠRepositoryã€‹](https://github.com/2881099/FreeSql/wiki/Repository) \| [ã€ŠUnitOfWorkã€‹](https://github.com/2881099/FreeSql/wiki/%e5%b7%a5%e4%bd%9c%e5%8d%95%e5%85%83) \| [ã€Šè¿‡æ»¤å™¨ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%bf%87%e6%bb%a4%e5%99%a8) \| [ã€Šä¹è§‚é”ã€‹](https://github.com/2881099/FreeSql/wiki/%e4%bf%ae%e6%94%b9#%E4%B9%90%E8%A7%82%E9%94%81) \| [ã€ŠDbContextã€‹](https://github.com/2881099/FreeSql/wiki/DbContext) |
| <img src="https://user-images.githubusercontent.com/16286519/55138284-0eea4f80-516e-11e9-8764-29264807f402.png" width="40" height="59"/> | [ã€Šè¯»å†™åˆ†ç¦»ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%af%bb%e5%86%99%e5%88%86%e7%a6%bb) \| [ã€Šåˆ†åŒºåˆ†è¡¨ã€‹](https://github.com/2881099/FreeSql/wiki/%e5%88%86%e5%8c%ba%e5%88%86%e8%a1%a8) \| [ã€Šç§Ÿæˆ·ã€‹](https://github.com/2881099/FreeSql/wiki/%e7%a7%9f%e6%88%b7) \| [ã€ŠAOPã€‹](https://github.com/2881099/FreeSql/wiki/AOP) \| [ã€Šé»‘ç§‘æŠ€ã€‹](https://github.com/2881099/FreeSql/wiki/%E9%AA%9A%E6%93%8D%E4%BD%9C) \| [*æ›´æ–°æ—¥å¿—*](https://github.com/2881099/FreeSql/wiki/%e6%9b%b4%e6%96%b0%e6%97%a5%e5%bf%97) |

# Packages

| Package Name |  NuGet | Downloads |
|--------------|  ------- |  ---- |
| FreeSql | [![nuget](https://img.shields.io/nuget/v/FreeSql.svg?style=flat-square)](https://www.nuget.org/packages/FreeSql) | [![stats](https://img.shields.io/nuget/dt/FreeSql.svg?style=flat-square)](https://www.nuget.org/stats/packages/FreeSql?groupby=Version) |
| FreeSql.Repository | [![nuget](https://img.shields.io/nuget/v/FreeSql.Repository.svg?style=flat-square)](https://www.nuget.org/packages/FreeSql.Repository) | [![stats](https://img.shields.io/nuget/dt/FreeSql.Repository.svg?style=flat-square)](https://www.nuget.org/stats/packages/FreeSql.Repository?groupby=Version) |
| FreeSql.DbContext | [![nuget](https://img.shields.io/nuget/v/FreeSql.DbContext.svg?style=flat-square)](https://www.nuget.org/packages/FreeSql.DbContext) | [![stats](https://img.shields.io/nuget/dt/FreeSql.DbContext.svg?style=flat-square)](https://www.nuget.org/stats/packages/FreeSql.DbContext?groupby=Version) |
| [FreeSql.AdminLTE](https://github.com/2881099/FreeSql.AdminLTE) | [![nuget](https://img.shields.io/nuget/v/FreeSql.AdminLTE.svg?style=flat-square)](https://www.nuget.org/packages/FreeSql.AdminLTE) | [![stats](https://img.shields.io/nuget/dt/FreeSql.AdminLTE.svg?style=flat-square)](https://www.nuget.org/stats/packages/FreeSql.AdminLTE?groupby=Version) |

> FreeSql æä¾›äº†äº”ç§ä½¿ç”¨ä¹ æƒ¯ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å›¢é˜Ÿåˆé€‚çš„ä¸€ç§ï¼š

- è¦ä¹ˆFreeSqlï¼ŒåŸå§‹ç”¨æ³•ï¼›
- è¦ä¹ˆ[FreeSql.Repository](https://github.com/2881099/FreeSql/wiki/Repository)ï¼Œä»“å‚¨+å·¥ä½œå•å…ƒä¹ æƒ¯ï¼›
- è¦ä¹ˆ[FreeSql.DbContext](https://github.com/2881099/FreeSql/wiki/DbContext)ï¼Œæœ‰ç‚¹åƒefcoreçš„ä½¿ç”¨ä¹ æƒ¯ï¼›
- è¦ä¹ˆ[FreeSql.Connection.Extensions](https://github.com/2881099/FreeSql.Connection.Extensions)ï¼Œæœ‰ç‚¹åƒDapperçš„ä½¿ç”¨ä¹ æƒ¯ï¼›
- è¦ä¹ˆ[FreeSql.BaseEntity](https://github.com/2881099/FreeSql/tree/master/Examples/base_entity)ï¼Œæˆ‘æ±‚ç®€å•ç°åœ¨ä½¿ç”¨çš„è¿™ä¸ªï¼›

> [FluentApi ä¸ EfCore 90% ç›¸ä¼¼çš„æ‰©å±•åŒ…](https://github.com/2881099/FreeSql/tree/master/Extensions/FreeSql.Extensions.EfCoreFluentApi)ï¼›

> å­¦ä¹ é¡¹ç›®

- [ğŸ˜ƒ A simple and practical CMS implememted by .NET Core 2.2](https://github.com/luoyunchong/lin-cms-dotnetcore)
- [å†…å®¹ç®¡ç†ç³»ç»Ÿ](https://github.com/hejiyong/fscms)

æ¬¢è¿æ›´å¤šä½¿ç”¨ FreeSql çš„å¼€æºé¡¹ç›®åŠ å…¥ç›®å½•

# Providers

| Package Name | Version |
|--------------|  ------- |
| FreeSql.Provider.MySql | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Provider.MySqlConnector | NETStandard2.0ã€net45 |
| FreeSql.Provider.PostgreSQL | NETStandard2.0ã€net45 |
| FreeSql.Provider.SqlServer | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Provider.Sqlite | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Provider.Oracle | NETStandard2.0ã€net45ã€net40 |
| [FreeSql.Provider.Odbc](https://github.com/2881099/FreeSql/tree/master/Providers/FreeSql.Provider.Odbc) | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Extensions.LazyLoading | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Extensions.JsonMap | NETStandard2.0ã€net45ã€net40 |
| FreeSql.Extensions.BaseEntity | NETStandard2.0 |

# ConnectionStrings

| DataType | ConnectionString |
| --- | --- |
| DataType.MySql | Data Source=127.0.0.1;Port=3306;User ID=root;Password=root; Initial Catalog=cccddd;Charset=utf8; SslMode=none;Min pool size=1 |
| DataType.PostgreSQL | Host=192.168.164.10;Port=5432;Username=postgres;Password=123456; Database=tedb;Pooling=true;Minimum Pool Size=1 |
| DataType.SqlServer | Data Source=.;Integrated Security=True;Initial Catalog=freesqlTest;Pooling=true;Min Pool Size=1 |
| DataType.Oracle | user id=user1;password=123456; data source=//127.0.0.1:1521/XE;Pooling=true;Min Pool Size=1 |
| DataType.Sqlite | Data Source=\|DataDirectory\|\document.db; Attachs=xxxtb.db; Pooling=true;Min Pool Size=1 |
| DataType.OdbcMySql | Driver={MySQL ODBC 8.0 Unicode Driver}; Server=127.0.0.1;Persist Security Info=False; Trusted_Connection=Yes;UID=root;PWD=root; DATABASE=cccddd_odbc;Charset=utf8; SslMode=none;Min Pool Size=1 |
| DataType.OdbcSqlServer | Driver={SQL Server};Server=.;Persist Security Info=False; Trusted_Connection=Yes;Integrated Security=True; DATABASE=freesqlTest_odbc; Pooling=true;Min Pool Size=1 |
| DataType.OdbcOracle | Driver={Oracle in XE};Server=//127.0.0.1:1521/XE; Persist Security Info=False; Trusted_Connection=Yes;UID=odbc1;PWD=123456; Min Pool Size=1 |
| DataType.OdbcPostgreSQL | Driver={PostgreSQL Unicode(x64)};Server=192.168.164.10; Port=5432;UID=postgres;PWD=123456; Database=tedb_odbc;Pooling=true;Min Pool Size=1 |
| DataType.OdbcDameng (è¾¾æ¢¦) | Driver={DM8 ODBC DRIVER};Server=127.0.0.1:5236; Persist Security Info=False; Trusted_Connection=Yes; UID=USER1;PWD=123456789 |
| DataType.Odbc | Driver={SQL Server};Server=.;Persist Security Info=False; Trusted_Connection=Yes;Integrated Security=True; DATABASE=freesqlTest_odbc; Pooling=true;Min pool size=1 |

<p align="center">
  <img src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_functions06.png"/>
</p>

# Quick start

> dotnet add package FreeSql.Provider.Sqlite

```csharp
static IFreeSql fsql = new FreeSql.FreeSqlBuilder()
    .UseConnectionString(FreeSql.DataType.Sqlite, 
        @"Data Source=|DataDirectory|\document.db;Pooling=true;Max Pool Size=10")
    .UseAutoSyncStructure(true) //è‡ªåŠ¨åŒæ­¥å®ä½“ç»“æ„åˆ°æ•°æ®åº“
    .Build(); //è¯·åŠ¡å¿…å®šä¹‰æˆ Singleton å•ä¾‹æ¨¡å¼

class Song {
    [Column(IsIdentity = true)]
    public int Id { get; set; }
    public string Title { get; set; }
    public string Url { get; set; }
    public DateTime CreateTime { get; set; }

    public virtual ICollection<Tag> Tags { get; set; }
}
class Song_tag {
    public int Song_id { get; set; }
    public virtual Song Song { get; set; }

    public int Tag_id { get; set; }
    public virtual Tag Tag { get; set; }
}
class Tag {
    [Column(IsIdentity = true)]
    public int Id { get; set; }
    public string Name { get; set; }

    public int? Parent_id { get; set; }
    public virtual Tag Parent { get; set; }

    public virtual ICollection<Song> Songs { get; set; }
    public virtual ICollection<Tag> Tags { get; set; }
}
```

# Query
```csharp
//OneToOneã€ManyToOne
var t0 = fsql.Select<Tag>()
    .Where(a => a.Parent.Parent.Name == "ç²¤è¯­")
    .IncludeMany(a => a.Tags, then => then.Where(sub => sub.Name == "xxx"))
    .ToList();

//OneToMany
var t1 = fsql.Select<Tag>()
    .Where(a => a.Tags.AsSelect().Any(t => t.Parent.Id == 10))
    .ToList();

//ManyToMany
var t2 = fsql.Select<Song>()
    .Where(s => s.Tags.AsSelect().Any(t => t.Name == "å›½è¯­"))
    .IncludeMany(a => a.Tags, then => then.Where(sub => sub.Name == "xxx"))
    .ToList();

//Other
var t3 = fsql.Select<Xxx>()
    .Where(a => a.IsDelete == 0)
    .WhereIf(keyword != null, a => a.UserName.Contains(keyword))
    .WhereIf(role_id > 0, a => a.RoleId == role_id)
    .Where(a => a.Nodes.AsSelect().Any(t => t.Parent.Id == t.UserId))
    .Count(out var total)
    .Page(page, size)
    .OrderByDescending(a => a.Id)
    .ToList()
```
æ›´å¤šå‰å¾€Wikiï¼š[ã€ŠSelect æŸ¥è¯¢æ•°æ®æ–‡æ¡£ã€‹](https://github.com/2881099/FreeSql/wiki/%e6%9f%a5%e8%af%a2)

```csharp
var t3 = fsql.Select<Song>()
    .Where(a => new[] { 1, 2, 3 }.Contains(a.Id))
    .ToList();
```
```csharp
var t4 = fsql.Select<Song>()
    .Where(a => a.CreateTime.Date == DateTime.Now.Date)
    .ToList();
```
```csharp
var t5 = fsql.Select<Song>()
    .OrderBy(a => Guid.NewGuid())
    .Limit(1)
    .ToList();
```
æ›´å¤šå‰å¾€Wikiï¼š[ã€Šè¡¨è¾¾å¼å‡½æ•°ã€‹](https://github.com/2881099/FreeSql/wiki/%e8%a1%a8%e8%be%be%e5%bc%8f%e5%87%bd%e6%95%b0) 

# Repository & UnitOfWork
> dotnet add package FreeSql.Repository

```csharp
using (var uow = fsql.CreateUnitOfWork()) {
    var repo1 = uow.GetRepository<Song, int>();
    var repo2 = uow.GetRepository<Tag, int>();

    await repo1.InsertAsync(new Song());
    await repo2.InsertAsync(new Tag());
    uow.Commit();
}
```

# DbContext & DbSet
> dotnet add package FreeSql.DbContext

```csharp
using (var ctx = new fsql.CreateDbContext()) {
    var songs = ctx.Set<Song>();
    var tags = ctx.Set<Tag>();

    var tag = new Tag {
        Name = "testaddsublist",
        Tags = new[] {
            new Tag { Name = "sub1" },
            new Tag { Name = "sub2" },
            new Tag {
                Name = "sub3",
                Tags = new[] {
                    new Tag { Name = "sub3_01" }
                }
            }
        }
    };
    //tags.Add(tag);
    ctx.Add(tag);
    await ctx.SaveChangesAsync();
}
```

# Performance

FreeSql Query & Dapper Query
```shell
Elapsed: 00:00:00.6733199; Query Entity Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.4554230; Query Tuple Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.6846146; Query Dynamic Counts: 131072; ORM: Dapper

Elapsed: 00:00:00.6818111; Query Entity Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.6060042; Query Tuple Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.4211323; Query ToList<Tuple> Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:01.0236285; Query Dynamic Counts: 131072; ORM: FreeSql*
```

FreeSql ToList & Dapper Query
```shell
Elapsed: 00:00:00.6707125; ToList Entity Counts: 131072; ORM: FreeSql*

Elapsed: 00:00:00.6495301; Query Entity Counts: 131072; ORM: Dapper
```

[Test code](FreeSql.Tests.PerformanceTests/MySqlAdoTest.cs)ã€[More](https://github.com/2881099/FreeSql/wiki/%e6%80%a7%e8%83%bd)

# Contributors

[systemhejiyong](https://github.com/systemhejiyong)ã€
[LambertW](https://github.com/LambertW)ã€
[mypeng1985](https://github.com/mypeng1985)ã€
[stulzq](https://github.com/stulzq)ã€
[movingsam](https://github.com/movingsam)ã€
[ALer-R](https://github.com/ALer-R)ã€
[zouql](https://github.com/zouql)ã€
æ·±åœ³|å‡‰èŒ¶ã€
[densen2014](https://github.com/densen2014)ã€
[LiaoLiaoWuJu](https://github.com/LiaoLiaoWuJu)ã€
[hd2y](https://github.com/hd2y)ã€
[tky753](https://github.com/tky753)

ï¼ˆQQç¾¤ï¼š4336577ï¼‰

# Donation

L*y 58å…ƒã€èŠ±èŠ± 88å…ƒã€éº¦å…œå¾ˆä¹– 50å…ƒã€ç½‘ç»œæ¥è€… 2000å…ƒã€John 99.99å…ƒã€alex 666å…ƒ

> Thank you for your donation

| | |
| - | - |
| <img height="210" src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200123075118IMG_7935(20200123-154947).JPG"/> | <img height="210" src="https://images.cnblogs.com/cnblogs_com/kellynic/133561/o_200123075928IMG_7936(20200123-155553).JPG"/> |

